#!/bin/sh

dvdnav_sh_version=4.1.1
dvdnav_sh_major=`echo $dvdnav_sh_version | awk -F. '{print $1}'`

show_help(){
  echo "Usage: configure [options]"
  echo "Options: [defaults in brackets after descriptions]"
  echo
  echo "Standard options:"
  echo "  --help                   print this message"
  echo "  --prefix=PREFIX          install in PREFIX [$PREFIX]"
  echo "  --libdir=DIR             install libs in DIR [PREFIX/lib]"
  echo "  --shlibdir=DIR           install shared libs in DIR [PREFIX/lib]"
  echo "  --incdir=DIR             install includes in DIR [PREFIX/include/dvdnav]"
  echo "  --enable-static          build static libraries [default=yes]"
  echo "  --disable-static         do not build static libraries [default=no]"
  echo "  --enable-shared          build shared libraries [default=no]"
  echo "  --disable-shared         do not build shared libraries [default=yes]"
  echo "  --enable-debug           install with debugging symbols [default=no]"
  exit 1
}

SHARED=yes
STATIC=yes
PREFIX=/usr/local/
INSTALLSTRIP=-s

for opt do
  optval="${opt#*=}"
  case "$opt" in
  --enable-debug) INSTALLSTRIP=
  ;;
  --enable-shared) SHARED=yes
  ;;
  --disable-shared) SHARED=no
  ;;
  --enable-static) STATIC=yes
  ;;
  --disable-static) STATIC=no
  ;;
  --prefix=*) PREFIX="$optval"
  ;;
  --libdir=*) libdir="$optval"
  ;;
  --shlibdir=*) shlibdir="$optval"
  ;;
  --incdir=*) incdir="$optval"
  ;;
  --help) show_help
  ;;
  esac
done

PREFIX=`cd $PREFIX && pwd`

test -z $libdir && libdir=$PREFIX/lib
test -z $shlibdir && shlibdir=$PREFIX/lib
test -z $incdir && incdir=$PREFIX/include/dvdnav

cat > config.mak << EOF 
# Automatically generated by configure, do not edit
PREFIX=$PREFIX
libdir=$libdir
shlibdir=$shlibdir
incdir=$incdir
BUILD_SHARED=$SHARED
BUILD_STATIC=$STATIC
SHLIB_VERSION=$dvdnav_sh_version
SHLIB_MAJOR=$dvdnav_sh_major
INSTALLSTRIP=$INSTALLSTRIP
EOF

cat > config.h << EOF
/* Automatically generated by configure, do not edit */
#include "version.h"
EOF

echo
echo "Done, type 'make install' to build and install"

